<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>漂泊者乐园象棋 《谁能解》</title>
    <script type="text/javascript" src="book.js"></script>
    <script type="text/javascript" src="position.js"></script>
    <script type="text/javascript" src="search.js"></script>
    <script type="text/javascript" src="board.js"></script>
    <script type="text/javascript" src="cchess.js"></script>
    <style type="text/css"><!--
body {  background: url(../background.gif);}
span.td {  display: inline-block;}
div.label {  font-size: 14px;  padding:2px;}
select {  font-size: 14px;  width: 108px;  padding:2px;}
option {  font-size: 14px;}

input.button {  font-size: 14px;  width: 108px;}
label {  font-size: 14px;}
    --></style>  </head>
<body>
    <div><button id="id_btn_4_blChess">漂泊者乐园象棋</button> <button id="id_btn_4_snj">谁能解</button> <div id="id_div_4_fen"></div>红先走
      <a target="blank" href="https://github.com/littleflute/cchess/edit/master/play/snj.html">V0.0. 133 </a>      
      <a target="blank" href="..">..</a>
      <a target="blank" href="https://littleflute.github.io/cchess/ref/vschess_1.2.0/demo.html">demo </a>
      <br><button id="id_btn_4_blApp">++++++++++++++++++++++blApp++++++++++++++++++</button> 
    </div>
   
    <div style="text-align:center;white-space:nowrap">
      <span class="td" style="margin-right:10px">
        <div id="container"></div>
      </span><span class="td" style="vertical-align:top;width:120px;"><div style="text-align:left">
 
   
 
        <div style="padding-top:2px"><input type="button" class="button" value="重新开始" onclick="restart_click()"></div>
        <div style="padding-top:2px"><input type="button" class="button" value="悔棋" onclick="retract_click()"></div>
        <div style="height:12px"></div>
       

        <div style="height:12px"></div>
        <div><input type="checkbox" class="checkbox" id="chkAnimated" checked onclick="board.animated = checked"><label for="chkAnimated">动画</label></input></div>
        <div><input type="checkbox" class="checkbox" checked onclick="board.setSound(checked)"><label for="chkSound">音效</label></input></div>
        <div style="height:60px"></div>
        <div class="label">步骤</div>
        <div><select id="selMoveList" size="10" style="font-family:宋体" onchange="moveList_change()">
          <option selected value="0">=== 开始 ===</option>
        </select></div>
      </div></span>
    </div>
    <script type="text/javascript"><!--
"use strict";
 
function createOption(text, value, ie8) {
  var opt = document.createElement("option");
  opt.selected = true;
  opt.value = value;
  if (ie8) {
    opt.text = text;
  } else {
    opt.innerHTML = text.replace(/ /g, "&nbsp;");
  }
  return opt;
}

var board = new Board(container, "images/", "sounds/");
board.setSearch(16);
board.millis = 1000;
board.computer = 1;
board.fen = "3ak4/4aP3/9/9/p1b6/9/9/7C1/4K4/9 w";
board.onAddMove = function() {
  var counter = (board.pos.mvList.length >> 1);
  var space = (counter > 99 ? "    " : "   ");
  counter = (counter > 9 ? "" : " ") + counter + ".";
  var text = (board.pos.sdPlayer == 0 ? space : counter) + move2Iccs(board.mvLast);
  var value = "" + board.mvLast;
  try {
    selMoveList.add(createOption(text, value, false));
  } catch (e) {
    selMoveList.add(createOption(text, value, true));
  }
  selMoveList.scrollTop = selMoveList.scrollHeight;
};

function level_change() {
  board.millis = Math.pow(10, selLevel.selectedIndex + 1);
}

function restart_click() {
  selMoveList.options.length = 1;
  selMoveList.selectedIndex = 0;
  board.computer = 1;
  board.restart(board.fen);
}

function retract_click() {
  for (var i = board.pos.mvList.length; i < selMoveList.options.length; i ++) {
    board.pos.makeMove(parseInt(selMoveList.options[i].value));
  }
  board.retract();
  selMoveList.options.length = board.pos.mvList.length;
  selMoveList.selectedIndex = selMoveList.options.length - 1;
}

function moveList_change() {
  if (board.result == RESULT_UNKNOWN) {
    selMoveList.selectedIndex = selMoveList.options.length - 1;
    return;
  }
  var from = board.pos.mvList.length;
  var to = selMoveList.selectedIndex;
  if (from == to + 1) {
    return;
  }
  if (from > to + 1) {
    for (var i = to + 1; i < from; i ++) {
      board.pos.undoMakeMove();
    }
  } else {
    for (var i = from; i <= to; i ++) {
      board.pos.makeMove(parseInt(selMoveList.options[i].value));
    }
  }
  board.flushBoard();
}

var QueryString = function () {
  // This function is anonymous, is executed immediately and 
  // the return value is assigned to QueryString!
  var query_string = {};
  var query = window.location.search.substring(1);
  var vars = query.split("&");
  for (var i=0;i<vars.length;i++) {
    var pair = vars[i].split("=");
        // If first entry with this name
    if (typeof query_string[pair[0]] === "undefined") {
      query_string[pair[0]] = decodeURIComponent(pair[1]);
        // If second entry with this name
    } else if (typeof query_string[pair[0]] === "string") {
      var arr = [ query_string[pair[0]],decodeURIComponent(pair[1]) ];
      query_string[pair[0]] = arr;
        // If third or later entry with this name
    } else {
      query_string[pair[0]].push(decodeURIComponent(pair[1]));
    }
  } 
  return query_string;
}();
function bl$(id){	return document.getElementById(id); }
if(QueryString.f) board.fen = QueryString.f;
var d = bl$("id_div_4_fen");
d.innerHTML = QueryString.id;//board.fen;

restart_click();
    --></script>
<script src="https://littleflute.github.io/JavaScript/w3.js"></script>

<script src="https://littleflute.github.io/JavaScript/blclass.js"></script>

<script src="https://littleflute.github.io/JavaScript/blApp.js"></script>
  </body>
</html>
